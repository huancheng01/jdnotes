# Role
React & TypeScript Debugger.

# Symptom
The user clicks the "Create Note" button (either in the Sidebar or the Empty State view).
The note IS created in the background (visible in the list), BUT the view does not switch to the Editor. It stays on the "Select a note" screen.

# Diagnosis
This is 99% a **Type Mismatch** or **State Logic Error**.
- Dexie returns a `number` for the ID.
- The state `activeNoteId` might be typed as `string`, or the `find()` logic uses strict equality (`===`) causing failure.

# Goal
Rewrite the `handleCreateNote` function and the Main Render Logic in `App.tsx` to strictly handle ID types.

# Solution Requirements

## 1. Fix State Definition
Ensure `activeNoteId` allows numbers:
`const [activeNoteId, setActiveNoteId] = useState<number | null>(null);`

## 2. Robust `handleCreateNote`
Rewrite the function to:
- Use `async/await`.
- Capture the returned ID from `db.notes.add()`.
- **Force Type:** Ensure the ID is treated as a number.
- **Log:** Add `console.log('Created Note ID:', id)` for debugging.
- **Set State:** Call `setActiveNoteId(id)` immediately.

## 3. Wire Up the "Empty State" Button
The user's screenshot shows a large "Create Note" button in the middle of the screen.
- Ensure this button's `onClick` prop is actually pointing to `handleCreateNote`.

## 4. Safe Active Note Derivation
In the render part of `App.tsx`:
- Use `const activeNote = notes?.find(n => n.id === activeNoteId);`
- **Crucial:** Add a fallback check. If `notes` exists but `activeNote` is undefined *right after creation*, we might need to rely on the ID or wait for the re-render.
- However, fixing the type (String vs Number) usually solves this instantly.

# Deliverables
Provide the corrected `App.tsx` logic block, specifically:
1. The `useState` line.
2. The `handleCreateNote` function.
3. The `activeNote` finding logic.
4. The JSX for the "Empty State" component showing the correct `onClick` binding.

# Sample Code to Generate
```typescript
  const handleCreateNote = async () => {
    try {
      const id = await db.notes.add({
        title: '无标题',
        content: '',
        createdAt: new Date(),
        updatedAt: new Date()
      });
      // Dexie returns the ID (number). Force update state.
      setActiveNoteId(Number(id)); 
    } catch (error) {
      console.error("Failed to create note:", error);
    }
  };